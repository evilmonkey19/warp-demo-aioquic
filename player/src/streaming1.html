<!doctype html>
<html>

<head>
	<meta charset = "UTF-8">
	<title>WARP</title>

	<link rel="stylesheet" href="player.css">
</head>

<body>
	<div id="player">
		<div id="screen">
			<div id="play"><span>click to play</span></div>
			<video id="vid" controls></video>
		</div>

		<div>
			<button><a href="index.html">Go Back</a></button>
		</div>

	</div>

	<script type="module">
		import { Player } from "./player.ts"

		// This is so ghetto but I'm too lazy to improve it right now
		const vidRef = document.getElementById("vid")
		const playRef = document.getElementById("play")

		const params = new URLSearchParams(window.location.search)

		const player = new Player({
			url: params.get("url") || "https://localhost.warp.demo:4441",

			vid: vidRef,
		})
		vidRef.play()

		playRef.addEventListener('click', (e) => {
			vidRef.play()
			e.preventDefault()
		})

		function playFunc(e) {
			playRef.style.display = "none"
			//player.goLive()

			// Only fire once to restore pause/play functionality
			vidRef.removeEventListener('play', playFunc)
		}

		vidRef.addEventListener('play', playFunc)
		vidRef.volume = 0.5

		// Try to autoplay but ignore errors on mobile; they need to click
		//vidRef.play().catch((e) => console.warn(e))
	</script>
</body>
</html>
